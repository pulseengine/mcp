# MCP Apps Extension - Interactive React UI Example

This example demonstrates a complete implementation of the **MCP Apps Extension (SEP-1865)** with a **React-based interactive UI** that communicates bidirectionally with an MCP server using the `@mcp-ui/client` SDK.

## ğŸ¯ What This Demonstrates

### Server Side (Rust)

- âœ… Tools linked to UI resources via `_meta["ui/resourceUri"]`
- âœ… UI resources with `ui://` URI scheme
- âœ… HTML served with `text/html+mcp` MIME type
- âœ… Resource fallback (React build or simple HTML template)

### Client Side (React + TypeScript)

- âœ… React component using `@mcp-ui/client` SDK
- âœ… `useMCPClient()` hook for MCP host communication
- âœ… Receiving host context (theme, viewport, device capabilities, tool info)
- âœ… Making tool calls back to the server from the UI
- âœ… Connection state management
- âœ… Error handling and loading states
- âœ… Responsive design with dark mode support

## ğŸ“¦ Project Structure

```
ui-enabled-server/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ main.rs                 # Rust MCP server implementation
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ greeting.html           # Fallback simple HTML template
â”œâ”€â”€ ui/                         # React UI application
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.tsx           # React app entry point
â”‚   â”‚   â”œâ”€â”€ GreetingUI.tsx     # Main UI component with MCP integration
â”‚   â”‚   â”œâ”€â”€ GreetingUI.css     # Component styles
â”‚   â”‚   â””â”€â”€ index.css          # Global styles
â”‚   â”œâ”€â”€ index.html             # HTML shell
â”‚   â”œâ”€â”€ package.json           # Node dependencies
â”‚   â”œâ”€â”€ vite.config.ts         # Vite build configuration
â”‚   â””â”€â”€ tsconfig.json          # TypeScript configuration
â”œâ”€â”€ static/                     # Built UI output (generated by `npm run build`)
â”‚   â”œâ”€â”€ index.html
â”‚   â””â”€â”€ assets/
â””â”€â”€ UI_README.md               # This file
```

## ğŸš€ Quick Start

### 1. Build the React UI

```bash
cd examples/ui-enabled-server/ui

# Install dependencies
npm install

# Build for production (outputs to ../static/)
npm run build
```

### 2. Run the MCP Server

```bash
# From the workspace root
cargo run --bin ui-enabled-server
```

### 3. Test with MCP Inspector

```bash
# In another terminal, run MCP Inspector
npx @modelcontextprotocol/inspector cargo run --bin ui-enabled-server
```

Then in the Inspector:

1. **Tools** â†’ Click `greet_with_ui` â†’ Notice the `_meta` field with `ui/resourceUri`
2. **Resources** â†’ Click `ui://greetings/interactive` â†’ See the React UI load
3. **Interact** â†’ Enter a name, click "Say Hello", see the tool call response

## ğŸ› ï¸ Development Workflow

### UI Development Mode

For rapid UI development with hot reload:

```bash
cd examples/ui-enabled-server/ui

# Start Vite dev server (opens browser at http://localhost:5173)
npm run dev
```

**Note:** In dev mode, the UI runs standalone and won't have access to the MCP host context. For full MCP integration testing, you need to:

1. Build the UI (`npm run build`)
2. Run the MCP server
3. Test through MCP Inspector

### Making Changes

#### To modify the UI:

1. Edit files in `ui/src/`
2. Run `npm run build` to rebuild
3. Restart the Rust server
4. Refresh MCP Inspector

#### To modify the server:

1. Edit `src/main.rs`
2. Rebuild: `cargo build --bin ui-enabled-server`
3. Restart the server

## ğŸ“š Key Implementation Details

### React Component with MCP Integration

```typescript
function GreetingUI() {
  const [isConnected, setIsConnected] = useState(false);
  const [context, setContext] = useState<any>(null);

  useEffect(() => {
    const initMCP = async () => {
      if (window.mcp) {
        setIsConnected(true);
        const ctx = await window.mcp.getContext();
        setContext(ctx);
      }
    };
    initMCP();
  }, []);

  // context provides:
  // - hostInfo: { name, version }
  // - theme: 'light' | 'dark' | 'system'
  // - displayMode: 'inline' | 'fullscreen' | ...
  // - viewport: { width, height }
  // - locale, timezone, platform, device
  // - tool: { name, arguments, requestId }

  const handleGreet = async () => {
    const result = await window.mcp.callTool({
      name: "greet_with_ui",
      arguments: { name: "Alice" },
    });
    // Handle result...
  };
}
```

### Rust Server Resource Handler

```rust
async fn read_resource(
    &self,
    params: ReadResourceRequestParam,
) -> Result<ReadResourceResult, Self::Error> {
    match params.uri.as_str() {
        "ui://greetings/interactive" => {
            let html = include_str!("../static/index.html");
            Ok(ReadResourceResult {
                contents: vec![ResourceContents::html_ui(params.uri, html)],
            })
        }
        _ => Err(CommonMcpError::InvalidParams("Resource not found".to_string())),
    }
}
```

## ğŸ¨ UI Features

### Host Context Display

The UI automatically displays information from the MCP host:

- Host name and version
- Theme preference (light/dark/system)
- Display mode (inline/fullscreen/etc.)
- Viewport dimensions
- Locale and timezone
- Tool invocation context

### Interactive Tool Calls

- Input field for entering a name
- Button to trigger `greet_with_ui` tool call
- Loading state during tool execution
- Error handling with user-friendly messages
- Success display of server response

### Responsive Design

- Mobile-friendly layout
- Dark mode support (follows host theme)
- Accessible form controls
- Smooth animations and transitions

## ğŸ§ª Testing Checklist

- [ ] UI builds successfully (`npm run build` in `ui/` directory)
- [ ] Server compiles (`cargo build --bin ui-enabled-server`)
- [ ] MCP Inspector connects to server
- [ ] `tools/list` shows `greet_with_ui` with `_meta["ui/resourceUri"]`
- [ ] `resources/list` shows `ui://greetings/interactive`
- [ ] `resources/read` returns HTML with `text/html+mcp` MIME type
- [ ] UI loads in MCP Inspector resource viewer
- [ ] UI displays host context information correctly
- [ ] Connection status shows "Connected"
- [ ] Entering name and clicking "Say Hello" triggers tool call
- [ ] Server response appears in "Server Response" section
- [ ] Reset button clears the form
- [ ] UI is responsive on different viewport sizes

## ğŸ“– Resources

### MCP UI Documentation

- **Client SDK**: [npmjs.com/package/@mcp-ui/client](https://www.npmjs.com/package/@mcp-ui/client)
- **Documentation**: [mcpui.dev](https://mcpui.dev)
- **React Examples**: [mcpui.dev/guide/client/react-usage-examples](https://mcpui.dev/guide/client/react-usage-examples)
- **Live Demo**: [Scira MCP Chat](https://scira-mcp-chat-git-main-idosals-projects.vercel.app/)

### MCP Apps Extension

- **Blog Post**: [MCP Apps Announcement](https://blog.modelcontextprotocol.io/posts/2025-11-21-mcp-apps/)
- **Specification**: [SEP-1865](https://github.com/modelcontextprotocol/ext-apps)
- **Protocol Details**: [apps.mdx](https://github.com/modelcontextprotocol/ext-apps/blob/main/specification/draft/apps.mdx)

### PulseEngine MCP

- **Framework Docs**: `../../docs/MCP_APPS_EXTENSION.md`
- **Protocol Crate**: `../../mcp-protocol/`
- **Server Crate**: `../../mcp-server/`

## ğŸ”§ Troubleshooting

### UI doesn't load

- âœ… Check that `npm run build` completed successfully
- âœ… Verify `static/index.html` exists
- âœ… Check server console for errors
- âœ… Ensure resource URI matches: `ui://greetings/interactive`

### "Not connected to MCP host" error

- âœ… UI must be loaded through MCP Inspector or compatible host
- âœ… Cannot test standalone (needs MCP host context)
- âœ… Check MCP Inspector console for connection errors

### Tool calls fail

- âœ… Verify server is running and responsive
- âœ… Check tool name matches exactly: `greet_with_ui`
- âœ… Ensure arguments format is correct: `{ name: string }`
- âœ… Look for errors in server console

### Build errors

- âœ… Run `npm install` to ensure dependencies are installed
- âœ… Check Node.js version (requires v18+)
- âœ… Clear `node_modules` and reinstall if needed
- âœ… Verify `package.json` has all required dependencies

## ğŸ“ Next Steps

1. **Customize the UI**: Modify `GreetingUI.tsx` to add more features
2. **Add More Tools**: Extend `main.rs` with additional UI-enabled tools
3. **Implement CSP**: Add Content Security Policy for external API access
4. **Add Visualizations**: Use charting libraries (Chart.js, D3, etc.)
5. **Enhance Styling**: Customize `GreetingUI.css` for your branding
6. **Add State Management**: Integrate Redux or Zustand for complex UIs
7. **Build Production App**: Deploy as part of a larger MCP server

## ğŸ“ License

This example is part of the PulseEngine MCP framework and follows the same license.

---

**Built with**:

- [PulseEngine MCP](https://github.com/pulseengine/mcp-framework) - Rust MCP Server Framework
- [@mcp-ui/client](https://www.npmjs.com/package/@mcp-ui/client) - MCP UI Client SDK
- [React](https://react.dev/) - UI Library
- [Vite](https://vite.dev/) - Build Tool
- [TypeScript](https://www.typescriptlang.org/) - Type Safety
